INSERT INTO storeperfarchive (SLICETIME,PRODUCT_ID, QUANTITY, NUMSALES, STORE_ID) 
	
     SELECT NOW(), ps.PRODUCT_ID, ps.INSTOREQUANTITY, SUM(sl.QUANTITY) AS NUMSOLD, ps.STORE_ID 
     FROM productstorages ps 
     	left outer join storepayment sp 
        	on ps.STORE_ID=sp.STORE_ID 
     	join salelines sl 
     		on sp.PAYMENT_ID = sl.PAYMENT_ID and sl.PRODUCT_ID = ps.PRODUCT_ID 
     GROUP BY ps.PRODUCT_ID, ps.STORE_ID;
////
CREATE EVENT `SALESSLICEREVENT` ON SCHEDULE EVERY 1 HOUR STARTS '2016-06-13 20:10:00.000000' ENDS '2016-06-15 04:00:00.000000' ON COMPLETION PRESERVE ENABLE COMMENT 'ARCHIVES INFO ABOUT THE SALES AND STORAGES PER STORE ' DO INSERT INTO storeperfarchive (SLICETIME,PRODUCT_ID, QUANTITY, NUMSALES, STORE_ID) SELECT NOW(), ps.PRODUCT_ID, ps.INSTOREQUANTITY, SUM(sl.QUANTITY) AS NUMSOLD, ps.STORE_ID FROM productstorages ps left outer join storepayment sp on ps.STORE_ID=sp.STORE_ID join salelines sl on sp.PAYMENT_ID = sl.PAYMENT_ID and sl.PRODUCT_ID = ps.PRODUCT_ID GROUP BY ps.PRODUCT_ID, ps.STORE_ID;
